
= {page-component-title} Startup

This section describes troubleshooting steps for problems encountered while {page-component-title} starts.

[[java-errors]]
== Java errors

If you encounter a Java error when starting {page-component-title}, you should verify that your Java version is compatible:

[source, console]
runjava -s

If you run `systemctl start opennms` with a version of Java that is not compatible, the output displays error messages:

[source, shell]
----
opennms[80542]: Starting OpenNMS:
opennms[81178]: runjava: Error: configured JVM not found.
opennms[81178]: runjava: "/usr/lib/jvm/java-11-openjdk-11.0.17.0.8-1.el9_1.x86_64/bin/java" does not exist or is not executab>
opennms[81178]: runjava: Run "/opt/opennms/bin/runjava -s" to set up the java.conf file.
opennms[81178]: runjava:
opennms[81178]: runjava: You can install a JVM by downloading one from Oracle, or by running something like
opennms[81178]: runjava: 'apt-get install openjdk-11-jdk' or 'yum install java-11-openjdk-devel'.
opennms[80542]: OpenNMS was unable to connect to the 'opennms' database configured in opennms-datasources.xml.
opennms[80542]: failed
systemd[1]: opennms.service: Control process exited, code=exited, status=1/FAILURE
----

See xref:deployment:core/system-requirements.adoc[] for software compatibility requirements, including the supported versions of Java.

[[startup-errors]]
== Configuration errors

If you encounter a configuration error when starting {page-component-title}, you may need to run the {page-component-title} database installer, which updates the relational database schema to the latest version and applies any required changes to the configuration files:

[source, console]
install -dis
NOTE: Running or re-running the database installer is generally safe, provided you stop {page-component-title} first.

If you run `systemctl start opennms` and {page-component-title} is not installed or up to date, the output displays error messages:

[source, shell]
----
opennms[119337]: /opt/opennms/etc/configured does not exist.
opennms[119337]: You need to run the installer to set up the database.  In most
opennms[119337]: cases, it is enough to run:
opennms[119337]:   /opt/opennms/bin/install -dis
opennms[119337]: For details, see the install guide at:
opennms[119337]: http://www.opennms.org/index.php/QuickStart#Initialize_OpenNMS_and_the_Database
opennms[119134]: failed
systemd[1]: opennms.service: Control process exited, code=exited, status=1/FAILURE
systemd[1]: opennms.service: Failed with result 'exit-code'.
systemd[1]: Failed to start OpenNMS server.
----

NOTE: You can also run `config-tester -a` to verify your configuration settings.
If the tests pass, a success message is displayed.

[[database-errors]]
== Database errors

If you encounter a database error when starting {page-component-title}, database access may not have been configured properly.
In this case, error messages are displayed when you run `systemctl start opennms`:

[source, shell]
---
systemd[1]: Starting OpenNMS server...
opennms[133961]: Starting OpenNMS:
opennms[134703]: error invoking "check" operation: Data source 'opennms' failed.
opennms[133961]: OpenNMS was unable to connect to the 'opennms' database configured in opennms-datasources.xml.
opennms[133961]: failed
systemd[1]: opennms.service: Control process exited, code=exited, status=1/FAILURE
systemd[1]: opennms.service: Failed with result 'exit-code'.
systemd[1]: Failed to start OpenNMS server.
----

NOTE: See xref:deployment:core/getting-started.adoc#setup-postgresql[Set up PostgreSQL] for information on installing and setting up PostgreSQL.

[[upgrade-errors]]
== rpm, yum, dnf upgrade errors

Sometimes, {page-component-title} startup may fail because there are RHEL-related `.rpmnew` or `.rpmsave` files located in `$OPENNMS_HOME`.
When you check the status of your instance, one of the following errors might be displayed:

.`.rpmnew` error
[source, shell]
----
opennms[8728]: OPENNMS_HOME (/opt/opennms) directory.
opennms[8728]: The format of the original files may have changed since
opennms[8728]: you modified them before installing a new version.
opennms[8728]: Please double-check that your configuration files are
opennms[8728]: up-to-date and delete any leftover .rpmnew files or
opennms[8728]: OpenNMS will not start.
opennms[8011]: failed
systemd[1]: opennms.service: Control process exited, code=exited, status=1/FAILURE
systemd[1]: opennms.service: Failed with result 'exit-code'.
systemd[1]: Failed to start OpenNMS server.
----

.`.rpmsave` error
[source, shell]
----
opennms[133068]: OPENNMS_HOME (/opt/opennms) directory.
opennms[133068]: The format of the original files may have changed since
opennms[133068]: you modified them before installing a new version.
opennms[133068]: Please double-check that your configuration files are
opennms[133068]: up-to-date and delete any leftover .rpmsave files or
opennms[133068]: OpenNMS will not start.
opennms[132345]: failed
systemd[1]: opennms.service: Control process exited, code=exited, status=1/FAILURE
systemd[1]: opennms.service: Failed with result 'exit-code'.
systemd[1]: Failed to start OpenNMS server.
----

NOTE: You should evaluate the `.rpmnew` or `.rpmsave` file against the original file with the same name to determine which to keep.
Delete the appropriate file, remove the `.rpmnew` or `.rpmsave` file extension (if applicable), and start {page-component-title}.

You can run the following command to identify any `.rpmnew` or `.rpmsave` files in your environment:

[source, shell]
$ sudo find $OPENNMS_HOME -name '*.rpm*' -exec ls -la {} \;